{"remainingRequest":"D:\\front-end files\\test\\my-gridsome\\node_modules\\babel-loader\\lib\\index.js??ref--1-1!D:\\front-end files\\test\\my-gridsome\\node_modules\\gridsome\\app\\fetch.js","dependencies":[{"path":"D:\\front-end files\\test\\my-gridsome\\node_modules\\gridsome\\app\\fetch.js","mtime":1628149246770},{"path":"D:\\front-end files\\test\\my-gridsome\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1628149244789},{"path":"D:\\front-end files\\test\\my-gridsome\\node_modules\\babel-loader\\lib\\index.js","mtime":1628149244548}],"contextDependencies":[],"result":["import \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport prefetch from './utils/prefetch';\nimport { unslashEnd } from './utils/helpers';\nimport { NOT_FOUND_PATH } from '~/.temp/constants';\nvar dataUrl = process.env.DATA_URL;\nvar isPrefetched = {};\nvar isLoaded = {};\nexport default (function (route) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var _options$shouldPrefet = options.shouldPrefetch,\n      shouldPrefetch = _options$shouldPrefet === void 0 ? false : _options$shouldPrefet,\n      _options$force = options.force,\n      force = _options$force === void 0 ? false : _options$force;\n\n  if (!process.isStatic) {\n    var _route$meta$dynamic = route.meta.dynamic,\n        dynamic = _route$meta$dynamic === void 0 ? false : _route$meta$dynamic;\n    var path = dynamic ? route.matched[0].path : route.path;\n\n    if (route.name === '*') {\n      path = NOT_FOUND_PATH;\n    }\n\n    return new Promise(function (resolve, reject) {\n      var onFail = function onFail(err) {\n        isLoaded[route.path] = null;\n        reject(err);\n      };\n\n      var onSuccess = function onSuccess(res) {\n        isLoaded[route.path] = null;\n        resolve(res);\n      };\n\n      if (force || !isLoaded[route.path]) {\n        isLoaded[route.path] = fetch(process.env.GRAPHQL_ENDPOINT, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            path: path,\n            dynamic: dynamic\n          })\n        }).then(function (res) {\n          return res.json();\n        });\n      }\n\n      isLoaded[route.path].then(function (res) {\n        if (res.errors) onFail(res.errors[0]);else if (res.code) onSuccess({\n          code: res.code\n        });else onSuccess({\n          data: res.data,\n          context: res.extensions ? res.extensions.context : {}\n        });\n        isLoaded[route.path] = null;\n      })[\"catch\"](onFail);\n    });\n  }\n\n  var hashMeta = document.querySelector('meta[name=\"gridsome:hash\"]').getAttribute('content');\n  return new Promise(function (resolve, reject) {\n    var usePath = route.name === '*' ? NOT_FOUND_PATH : route.path;\n    var jsonPath = route.meta.dataPath || unslashEnd(usePath) + '/index.json';\n    var absPath = unslashEnd(dataUrl) + jsonPath;\n\n    if (shouldPrefetch && !isLoaded[jsonPath]) {\n      if (!isPrefetched[jsonPath]) {\n        isPrefetched[jsonPath] = prefetch(absPath);\n      }\n\n      return isPrefetched[jsonPath].then(function () {\n        return resolve();\n      })[\"catch\"](function () {\n        return resolve();\n      });\n    }\n\n    if (!isLoaded[jsonPath]) {\n      isLoaded[jsonPath] = fetchJSON(absPath);\n    }\n\n    return isLoaded[jsonPath].then(function (res) {\n      if (res.hash !== hashMeta) {\n        reject(createError(\"Hash did not match: json=\".concat(res.hash, \", document=\").concat(hashMeta), 'INVALID_HASH'));\n      } else {\n        resolve(res);\n      }\n    })[\"catch\"](function (err) {\n      isLoaded[jsonPath] = null;\n      reject(err);\n    });\n  });\n});\n\nfunction createError(message, code) {\n  var error = new Error(message);\n  error.code = code;\n  return error;\n}\n\nfunction fetchJSON(jsonPath) {\n  return new Promise(function (resolve, reject) {\n    var req = new XMLHttpRequest();\n    req.open('GET', jsonPath, true);\n    req.withCredentials = true;\n\n    req.onload = function () {\n      switch (req.status) {\n        case 200:\n          {\n            var results;\n\n            try {\n              results = JSON.parse(req.responseText);\n            } catch (err) {\n              return reject(new Error(\"Failed to parse JSON from \".concat(jsonPath, \". \").concat(err.message, \".\")));\n            }\n\n            if (!results.hash) {\n              return reject(new Error(\"JSON data in \".concat(jsonPath, \" is missing a hash.\")));\n            }\n\n            return resolve(results);\n          }\n\n        case 404:\n          {\n            return reject(createError(req.statusText, req.status));\n          }\n      }\n\n      reject(new Error(\"Failed to fetch \".concat(jsonPath, \".\")));\n    };\n\n    req.onerror = function () {\n      reject(new Error(\"Failed to fetch \".concat(jsonPath, \".\")));\n    };\n\n    req.send(null);\n  });\n}",{"version":3,"sources":["D:/front-end files/test/my-gridsome/node_modules/gridsome/app/fetch.js"],"names":["prefetch","unslashEnd","NOT_FOUND_PATH","dataUrl","process","env","DATA_URL","isPrefetched","isLoaded","route","options","shouldPrefetch","force","isStatic","meta","dynamic","path","matched","name","Promise","resolve","reject","onFail","err","onSuccess","res","fetch","GRAPHQL_ENDPOINT","method","headers","body","JSON","stringify","then","json","errors","code","data","context","extensions","hashMeta","document","querySelector","getAttribute","usePath","jsonPath","dataPath","absPath","fetchJSON","hash","createError","message","error","Error","req","XMLHttpRequest","open","withCredentials","onload","status","results","parse","responseText","statusText","onerror","send"],"mappings":"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","sourcesContent":["import prefetch from './utils/prefetch'\r\nimport { unslashEnd } from './utils/helpers'\r\nimport { NOT_FOUND_PATH } from '~/.temp/constants'\r\n\r\nconst dataUrl = process.env.DATA_URL\r\nconst isPrefetched = {}\r\nconst isLoaded = {}\r\n\r\nexport default (route, options = {}) => {\r\n  const { shouldPrefetch = false, force = false } = options\r\n\r\n  if (!process.isStatic) {\r\n    const { dynamic = false } = route.meta\r\n    let path = dynamic ? route.matched[0].path : route.path\r\n\r\n    if (route.name === '*') {\r\n      path = NOT_FOUND_PATH\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const onFail = err => {\r\n        isLoaded[route.path] = null\r\n        reject(err)\r\n      }\r\n\r\n      const onSuccess = res => {\r\n        isLoaded[route.path] = null\r\n        resolve(res)\r\n      }\r\n\r\n      if (force || !isLoaded[route.path]) {\r\n        isLoaded[route.path] = fetch(process.env.GRAPHQL_ENDPOINT, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ path, dynamic })\r\n        })\r\n          .then(res => res.json())\r\n      }\r\n\r\n      isLoaded[route.path]\r\n        .then(res => {\r\n          if (res.errors) onFail(res.errors[0])\r\n          else if (res.code) onSuccess({ code: res.code })\r\n          else onSuccess({\r\n            data: res.data,\r\n            context: res.extensions\r\n              ? res.extensions.context\r\n              : {}\r\n          })\r\n          isLoaded[route.path] = null\r\n        })\r\n        .catch(onFail)\r\n    })\r\n  }\r\n\r\n  const hashMeta = document\r\n    .querySelector('meta[name=\"gridsome:hash\"]')\r\n    .getAttribute('content')\r\n\r\n  return new Promise((resolve, reject) => {\r\n    const usePath = route.name === '*' ? NOT_FOUND_PATH : route.path\r\n    const jsonPath = route.meta.dataPath || unslashEnd(usePath) + '/index.json'\r\n    const absPath = unslashEnd(dataUrl) + jsonPath\r\n\r\n    if (shouldPrefetch && !isLoaded[jsonPath]) {\r\n      if (!isPrefetched[jsonPath]) {\r\n        isPrefetched[jsonPath] = prefetch(absPath)\r\n      }\r\n\r\n      return isPrefetched[jsonPath]\r\n        .then(() => resolve())\r\n        .catch(() => resolve())\r\n    }\r\n\r\n    if (!isLoaded[jsonPath]) {\r\n      isLoaded[jsonPath] = fetchJSON(absPath)\r\n    }\r\n\r\n    return isLoaded[jsonPath]\r\n      .then(res => {\r\n        if (res.hash !== hashMeta) {\r\n          reject(\r\n            createError(\r\n              `Hash did not match: json=${res.hash}, document=${hashMeta}`,\r\n              'INVALID_HASH'\r\n            )\r\n          )\r\n        } else {\r\n          resolve(res)\r\n        }\r\n      })\r\n      .catch(err => {\r\n        isLoaded[jsonPath] = null\r\n        reject(err)\r\n      })\r\n  })\r\n}\r\n\r\nfunction createError (message, code) {\r\n  const error = new Error(message)\r\n  error.code = code\r\n  return error\r\n}\r\n\r\nfunction fetchJSON (jsonPath) {\r\n  return new Promise((resolve, reject) => {\r\n    const req = new XMLHttpRequest()\r\n\r\n    req.open('GET', jsonPath, true)\r\n    req.withCredentials = true\r\n\r\n    req.onload = () => {\r\n      switch (req.status) {\r\n        case 200: {\r\n          let results\r\n\r\n          try {\r\n            results = JSON.parse(req.responseText)\r\n          } catch (err) {\r\n            return reject(\r\n              new Error(`Failed to parse JSON from ${jsonPath}. ${err.message}.`)\r\n            )\r\n          }\r\n\r\n          if (!results.hash) {\r\n            return reject(\r\n              new Error(`JSON data in ${jsonPath} is missing a hash.`)\r\n            )\r\n          }\r\n\r\n          return resolve(results)\r\n        }\r\n        case 404: {\r\n          return reject(createError(req.statusText, req.status))\r\n        }\r\n      }\r\n\r\n      reject(new Error(`Failed to fetch ${jsonPath}.`))\r\n    }\r\n\r\n    req.onerror = () => {\r\n      reject(new Error(`Failed to fetch ${jsonPath}.`))\r\n    }\r\n\r\n    req.send(null)\r\n  })\r\n}\r\n"]}]}